(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[871],{701:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create/[[...id]]",function(){return t(7641)}])},7641:function(e,r,t){"use strict";t.r(r);var n=t(4051),a=t.n(n),o=t(5893),c=t(9008),i=t(7294),s=t(6597),u=t(7451),l=t(9692),p=t(1163);function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function m(e,r,t,n,a,o,c){try{var i=e[o](c),s=i.value}catch(u){return void t(u)}i.done?r(s):Promise.resolve(s).then(n,a)}function f(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){f(e,r,t[r])}))}return e}function y(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return d(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.default=function(){var e={title:"",price:0,inStock:0,description:"",content:"",category:""},r=(0,i.useState)(e),t=r[0],n=r[1],d=t.title,v=t.price,b=t.inStock,x=t.description,g=t.content,j=t.category,N=(0,i.useState)([]),w=N[0],k=N[1],O=(0,i.useContext)(s.R),_=O.state,S=O.dispatch,T=_.categories,I=_.auth,P=(0,p.useRouter)().query.id,C=(0,i.useState)(!1),F=C[0],Y=C[1];(0,i.useEffect)((function(){P?(Y(!0),(0,l.Yu)("product/".concat(P)).then((function(e){n(e.product),k(e.product.images)}))):(Y(!1),n(e),k([]))}),[P]);var E=function(e){var r=e.target,a=r.name,o=r.value;n(h({},t,f({},a,o))),S({type:"NOTIFY",payload:{}})},A=function(){var e,r=(e=a().mark((function e(r){var n,o,c,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),"admin"===I.user.role){e.next=3;break}return e.abrupt("return",S({type:"NOTIFY",payload:{error:"Authentication is not valid."}}));case 3:if(d&&v&&b&&x&&g&&"all"!==j&&0!==w.length){e.next=5;break}return e.abrupt("return",S({type:"NOTIFY",payload:{error:"Please add all the fields."}}));case 5:if(S({type:"NOTIFY",payload:{loading:!0}}),n=[],o=w.filter((function(e){return!e.url})),c=w.filter((function(e){return e.url})),!(o.length>0)){e.next=13;break}return e.next=12,(0,u.E)(o);case 12:n=e.sent;case 13:if(!F){e.next=22;break}return e.next=17,(0,l.fP)("product/".concat(P),h({},t,{images:y(c).concat(y(n))}),I.token);case 17:if(!(i=e.sent).err){e.next=20;break}return e.abrupt("return",S({type:"NOTIFY",payload:{error:i.err}}));case 20:e.next=27;break;case 22:return e.next=24,(0,l.qC)("product",h({},t,{images:y(c).concat(y(n))}),I.token);case 24:if(!(i=e.sent).err){e.next=27;break}return e.abrupt("return",S({type:"NOTIFY",payload:{error:i.err}}));case 27:return e.abrupt("return",S({type:"NOTIFY",payload:{success:i.msg}}));case 28:case"end":return e.stop()}}),e)})),function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function c(e){m(o,n,a,c,i,"next",e)}function i(e){m(o,n,a,c,i,"throw",e)}c(void 0)}))});return function(e){return r.apply(this,arguments)}}();return(0,o.jsxs)("div",{className:"products_manager",children:[(0,o.jsx)(c.default,{children:(0,o.jsx)("title",{children:"Adicionar Produtos"})}),(0,o.jsxs)("form",{className:"row",onSubmit:A,children:[(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsx)("input",{type:"text",name:"title",value:d,placeholder:"T\xedtulo",className:"d-block my-4 w-100 p-2",onChange:E}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-sm-6",children:[(0,o.jsx)("label",{htmlFor:"price",children:"Pre\xe7o"}),(0,o.jsx)("input",{type:"number",name:"price",value:v,placeholder:"Price",className:"d-block w-100 p-2",onChange:E})]}),(0,o.jsxs)("div",{className:"col-sm-6",children:[(0,o.jsx)("label",{htmlFor:"price",children:"Dispon\xedvel"}),(0,o.jsx)("input",{type:"number",name:"inStock",value:b,placeholder:"inStock",className:"d-block w-100 p-2",onChange:E})]})]}),(0,o.jsx)("textarea",{name:"description",id:"description",cols:"30",rows:"4",placeholder:"Descri\xe7\xe3o",onChange:E,className:"d-block my-4 w-100 p-2",value:x}),(0,o.jsx)("textarea",{name:"content",id:"content",cols:"30",rows:"6",placeholder:"Detalhes",onChange:E,className:"d-block my-4 w-100 p-2",value:g}),(0,o.jsx)("div",{className:"input-group-prepend px-0 my-2",children:(0,o.jsxs)("select",{name:"category",id:"category",value:j,onChange:E,className:"custom-select text-capitalize",children:[(0,o.jsx)("option",{value:"all",children:"Categoria"}),T.map((function(e){return(0,o.jsx)("option",{value:e._id,children:e.name},e._id)}))]})}),(0,o.jsx)("button",{type:"submit",className:"btn btn-info my-2 px-4",children:F?"Update":"Criar"})]}),(0,o.jsxs)("div",{className:"col-md-6 my-4",children:[(0,o.jsxs)("div",{className:"input-group mb-3",children:[(0,o.jsx)("div",{className:"input-group-prepend",children:(0,o.jsx)("span",{className:"input-group-text",children:"Imagem"})}),(0,o.jsx)("div",{className:"custom-file border rounded",children:(0,o.jsx)("input",{type:"file",className:"custom-file-input",onChange:function(e){S({type:"NOTIFY",payload:{}});var r=[],t=0,n="",a=y(e.target.files);return 0===a.length?S({type:"NOTIFY",payload:{error:"Files does not exist."}}):(a.forEach((function(e){return e.size>1048576?n="The largest image size is 1mb":"image/jpeg"!==e.type&&"image/png"!==e.type?n="Image format is incorrect.":((t+=1)<=5&&r.push(e),r)})),n&&S({type:"NOTIFY",payload:{error:n}}),w.length+r.length>5?S({type:"NOTIFY",payload:{error:"Select up to 5 images."}}):void k(y(w).concat(y(r))))},multiple:!0,accept:"image/*"})})]}),(0,o.jsx)("div",{className:"row img-up mx-0",children:w.map((function(e,r){return(0,o.jsxs)("div",{className:"file_img my-1",children:[(0,o.jsx)("img",{src:e.url?e.url:URL.createObjectURL(e),alt:"",className:"img-thumbnail rounded"}),(0,o.jsx)("span",{onClick:function(){return function(e){var r=y(w);r.splice(e,1),k(r)}(r)},children:"X"})]},r)}))})]})]})]})}},7451:function(e,r,t){"use strict";t.d(r,{E:function(){return c}});var n=t(4051),a=t.n(n);function o(e,r,t,n,a,o,c){try{var i=e[o](c),s=i.value}catch(u){return void t(u)}i.done?r(s):Promise.resolve(s).then(n,a)}var c=function(){var e,r=(e=a().mark((function e(r){var t,n,o,c,i,s,u,l,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=!0,o=!1,c=void 0,e.prev=2,i=r[Symbol.iterator]();case 4:if(n=(s=i.next()).done){e.next=20;break}return u=s.value,(l=new FormData).append("file",u),l.append("upload_preset","anapessoaecommerce"),l.append("cloud_name","jonasprodrigues"),e.next=12,fetch("https://api.cloudinary.com/v1_1/jonasprodrigues/upload",{method:"POST",body:l});case 12:return p=e.sent,e.next=15,p.json();case 15:d=e.sent,t.push({public_id:d.public_id,url:d.secure_url});case 17:n=!0,e.next=4;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(2),o=!0,c=e.t0;case 26:e.prev=26,e.prev=27,n||null==i.return||i.return();case 29:if(e.prev=29,!o){e.next=32;break}throw c;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[2,22,26,34],[27,,29,33]])})),function(){var r=this,t=arguments;return new Promise((function(n,a){var c=e.apply(r,t);function i(e){o(c,n,a,i,s,"next",e)}function s(e){o(c,n,a,i,s,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}()}},function(e){e.O(0,[774,888,179],(function(){return r=701,e(e.s=r);var r}));var r=e.O();_N_E=r}]);